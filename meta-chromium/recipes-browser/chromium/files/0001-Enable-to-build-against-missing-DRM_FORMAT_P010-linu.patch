From 4e62c874c3f44feb434388b41ae707bb05fc114c Mon Sep 17 00:00:00 2001
From: Takuro Ashie <ashie@clear-code.com>
Date: Tue, 8 Jun 2021 13:47:47 +0900
Subject: [PATCH 1/3] Enable to build against missing DRM_FORMAT_P010 linux
 kernel

Signed-off-by: Takuro Ashie <ashie@clear-code.com>
---
 ui/gfx/linux/drm_util_linux.cc | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/ui/gfx/linux/drm_util_linux.cc b/ui/gfx/linux/drm_util_linux.cc
index 7abc662baeb28..575fc64917f13 100644
--- a/ui/gfx/linux/drm_util_linux.cc
+++ b/ui/gfx/linux/drm_util_linux.cc
@@ -44,8 +44,10 @@ int GetFourCCFormatFromBufferFormat(gfx::BufferFormat format) {
       return DRM_FORMAT_NV12;
     case gfx::BufferFormat::YUVA_420_TRIPLANAR:
       return DRM_FORMAT_INVALID;
+#ifdef DRM_FORMAT_P010
     case gfx::BufferFormat::P010:
       return DRM_FORMAT_P010;
+#endif // DRM_FORMAT_P010
   }
   return DRM_FORMAT_INVALID;
 }
@@ -74,8 +76,10 @@ gfx::BufferFormat GetBufferFormatFromFourCCFormat(int format) {
       return gfx::BufferFormat::YUV_420_BIPLANAR;
     case DRM_FORMAT_YVU420:
       return gfx::BufferFormat::YVU_420;
+#ifdef DRM_FORMAT_P010
     case DRM_FORMAT_P010:
       return gfx::BufferFormat::P010;
+#endif // DRM_FORMAT_P010
     default:
       NOTREACHED();
       return gfx::BufferFormat::BGRA_8888;
@@ -95,7 +99,9 @@ bool IsValidBufferFormat(uint32_t current_format) {
     case DRM_FORMAT_RGB565:
     case DRM_FORMAT_NV12:
     case DRM_FORMAT_YVU420:
+#ifdef DRM_FORMAT_P010
     case DRM_FORMAT_P010:
+#endif // DRM_FORMAT_P010
       return true;
     default:
       return false;
-- 
2.34.1

